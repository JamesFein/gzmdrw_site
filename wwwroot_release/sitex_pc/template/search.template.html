<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="renderer" content="webkit">
  <meta name="viewport"
    content="width=device-width,initial-scale=1.0,user-scalable=no,maximum-scale=1,viewport-fit=cover">
  <title> 搜索结果_${Site.name}</title>
  <meta name="robots" content="noindex, follow">
  <meta name="applicable-device" content="pc,mobile">
  <meta http-equiv="Cache-Control" content="no-transform">
  <link rel="shortcut icon" href="${Prefix}images/favicon.png">
  <link rel="dns-prefetch" href="${Site.link}">
  <link rel="stylesheet" id="stylesheet-css" href="${Prefix}css/style.6.14.1.1689415232.css" type="text/css"
    media="all">
  <link rel="stylesheet" id="font-awesome-css" href="${Prefix}css/font-awesome.css" type="text/css" media="all">
  <link rel="stylesheet" id="wp-block-library-css" href="${Prefix}css/style.min.css" type="text/css" media="all">
  <link rel="stylesheet" id="classic-theme-styles-css" href="${Prefix}css/classic-themes.min.css" type="text/css"
    media="all">
  <@cms_include file="block_top_style.template.html"></@cms_include>
  <link rel="stylesheet" id="wpcom-member-css" href="${Prefix}css/wpcom_member.css" type="text/css" media="all">
  <link rel="stylesheet" id="wpcom-member-pro-css" href="${Prefix}css/wpcom_member_pro.css" type="text/css" media="all">
  <link rel="stylesheet" id="QAPress-css" href="${Prefix}css/qapress.css" type="text/css" media="all">
  <style id="QAPress-inline-css" type="text/css">
    :root {
      --qa-color: #002FA7;
      --qa-hover: #002FA7;
    }
  </style>
  <script type="text/javascript" src="${Prefix}js/jquery.min.js" id="jquery-core-js"></script>
  <script type="text/javascript" src="${Prefix}js/jquery-migrate.min.js" id="jquery-migrate-js"></script>
  <script type="text/javascript" src="${Prefix}js/jquery.cookie.js"></script>
  <link rel="icon" href="${Prefix}images/favicon.png" sizes="32x32">
  <link rel="icon" href="${Prefix}images/favicon.png" sizes="192x192">
  <link rel="apple-touch-icon" href="${Prefix}images/favicon.png">
  <meta name="msapplication-TileImage" content="${Prefix}images/favicon.png">
  <!--[if lte IE 11]><script src="${Prefix}js/update.js"></script><![endif]-->
</head>

<body class="search search-results logged-in lang-cn el-boxed header-fixed style-by-toggle">
  <@cms_include file="header.template.html"></@cms_include>
  <div id="wrap" style="min-height: 673px;">
    <div class="wrap container">
      <ol class="breadcrumb" vocab="https://schema.org/" typeof="BreadcrumbList">
        <li class="home" property="itemListElement" typeof="ListItem"><a href="${Site.link}" property="item"
            typeof="WebPage"><span property="name" class="hide">${Site.name}</span>首页</a>
          <meta property="position" content="1">
        </li>
        <li class="active">
          <i class="wpcom-icon wi"><svg aria-hidden="true">
              <use xlink:href="#wi-arrow-right-3"></use>
            </svg></i>
          搜索结果
        </li>
      </ol>
      <div class="main">
        <div class="sec-panel sec-panel-default">
          <div class="sec-panel-head" style="display: none;">
            <h1>
              <span>为您找到 `<span id="search_word" style="color:red;">${Request.q!''}</span>` 相关结果 <span id="result_total"
                  style="color:red;">0</span>
                个</span>
            </h1>
          </div>
          <div class="sec-panel-body">
            <ul id="div_result" class="post-loop post-loop-default">
              <h2>正在查询...</h2>
            </ul>
            <ul class="pagination">

            </ul>
          </div>
        </div>
      </div>
      <aside class="sidebar fixed">
        <@cms_include file="block_recent.template.html"></@cms_include>
        <@cms_include file="block_recent_defi.template.html"></@cms_include>
      </aside>
    </div>
  </div>
  <@cms_include file="footer.template.html"></@cms_include>
  <@cms_include file="action.template.html"></@cms_include>
  <@cms_include file="h5_bottom.template.html"></@cms_include>

  <script type="text/javascript" id="main-js-extra">
    /* <![CDATA[ */
    var _xy_cms = {
      prefix: '${Prefix}',
      resource_prefix: '${ResourcePrefix}',
      api_prefix: '${ApiPrefix}',
      front_prefix: '${IsPreview?then(ApiPrefix, Prefix)}',
      site_id: '${Site.siteId}',
      publish_pipe: '${PublishPipeCode}',
      preview: '${IsPreview?string}' == 'true',
      query: "${Request.q!''}",
      page: "${Request.page!'1'}",
      firstPage: "${FirstPage}",
      otherPage: "${OtherPage}"
    }
    var _wpcom_js = { "webp": "", "ajaxurl": "", "theme_url": "", "slide_speed": "5000", "is_admin": "0", "js_lang": { "copy_done": "\u590d\u5236\u6210\u529f\uff01", "copy_fail": "\u6d4f\u89c8\u5668\u6682\u4e0d\u652f\u6301\u62f7\u8d1d\u529f\u80fd", "confirm": "\u786e\u5b9a", "qrcode": "\u4e8c\u7ef4\u7801", "page_loaded": "\u5df2\u7ecf\u5230\u5e95\u4e86", "no_content": "\u6682\u65e0\u5185\u5bb9", "load_failed": "\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01", "expand_more": "\u9605\u8bfb\u5269\u4f59 %s" }, "user_card_height": "356", "poster": { "notice": "\u8bf7\u957f\u6309\u4fdd\u5b58\u56fe\u7247\uff0c\u5c06\u5185\u5bb9\u5206\u4eab\u7ed9\u66f4\u591a\u597d\u53cb", "generating": "\u6b63\u5728\u751f\u6210\u6d77\u62a5\u56fe\u7247...", "failed": "\u6d77\u62a5\u56fe\u7247\u751f\u6210\u5931\u8d25" }, "video_height": "482", "fixed_sidebar": "1", "dark_style": "0", "font_url": "..\/css\/fonts.9b34824582affe8e.css", "follow_btn": "<i class=\"wpcom-icon wi\"><svg aria-hidden=\"true\"><use xlink:href=\"#wi-add\"><\/use><\/svg><\/i>\u5173\u6ce8", "followed_btn": "\u5df2\u5173\u6ce8", "user_card": "1" };
/* ]]> */
  </script>
  <script type="text/javascript" src="${Prefix}js/main.js" id="main-js"></script>
  <script type="text/javascript" src="${Prefix}js/icons-2.7.7.js" id="wpcom-icons-js"></script>

  <@cms_pagewidget code="ad_top"></@cms_pagewidget>
  <@cms_include file="block_user_login.template.html"></@cms_include>
  <@cms_include file="stat.template.html"></@cms_include>

  <script>
    function queryResult () {
      if (_xy_cms.query.length == 0) {
        jQuery("#div_result").html("<h2>请输入搜索词！</h2>");
        return;
      }
      var pageSize = 10;
      jQuery.ajax({
        url: _xy_cms.api_prefix + "api/cms/search/query?sid=" + _xy_cms.site_id + "&pp=" + _xy_cms.publish_pipe + "&q=" + _xy_cms.query + "&page=" + _xy_cms.page,
        type: "GET",
        success: function (res) {
          jQuery("#div_result").html("");
          if (res.code != 200) {
            wpcom_notice({ message: res.msg, type: "error", show: 1500 })
            return;
          }
          jQuery('#result_total').html(res.data.total);
          jQuery(".sec-panel-head").show();
          res.data.rows.forEach(row => {
            var hasLogo = row.logo && row.logo.length > 0;
            var html = '<li class="item ' + (hasLogo ? '' : 'item-no-thumb') + '">';
            if (hasLogo) {
              html += '<div class="item-img">'
                + '  <a class="item-img-inner" href="' + row.logo + '" title="' + row.title + '" target="_blank" rel="bookmark">'
                + '    <img width="480" height="300" src="' + row.logo + '" class="attachment-default size-default wp-post-image" alt="' + row.title + '" decoding="async"">'
                + '  </a>'
                + '  <a class="item-category" href="#" target="_blank">' + row.catalogName + '</a>'
                + '</div>';
            }
            html += '<div class="item-content">'
              + '  <h2 class="item-title">'
              + '    <a href="' + row.link + '" target="_blank" rel="bookmark">' + row.title + '</a>'
              + '  </h2>'
              + '<div class="item-excerpt"><p>' + row.fullText + "</p></div>"
              + '<div class="item-meta">';
            if (row.contributor) {
              html += '<div class="item-meta-li author">'
                + '      <a data-user="37" target="_blank" href="#" class="avatar j-user-card">'
                + '        <img alt="' + row.contributor.displayName + '" src="' + (row.contributor.avatar ? row.contributor.avatar : _xy_cms.prefix + 'images/default_avatar.png') + '" class="avatar avatar-60 photo" height="60" width="60"> <span>' + item.contributor.displayName + '</span>'
                + '      </a>'
                + '    </div>'
            }
            html += '  <span class="item-meta-li date" > ' + dateFormatCN(row.publishDate * 1000) + '</span>'
              + '  <div class="item-meta-right">'
              + '    <span class="item-meta-li likes" title="点赞数">'
              + '      <i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-thumb-up"></use></svg></i>' + row.likeCount
              + '    </span>'
              + '    <span class="item-meta-li views" title="阅读数">'
              + '      <i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-eye"></use></svg></i>' + row.likeCount
              + '    </span>'
              + '  </div>'
              + '</div></div></li>';
            jQuery("#div_result").append(html);
          });
          buildPageBar(parseInt(_xy_cms.page), pageSize, parseInt(res.data.total));
        }
      })
    }
    function buildPageBar (page, size, total) {
      var ele = jQuery(".pagination");
	  if (total == 0) {
		ele.html("");
		return;
	  }
      var pageCount = parseInt((total + size - 1) / size);
      ele.append('<li class="disabled"><span>' + page + ' / ' + pageCount + '</span></li>');
      if (page > 1) {
        if (page == 2) {
          ele.append('<li class="prev"><a href="' + _xy_cms.firstPage + '" class="prev"><span>上一页</span><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-arrow-left"></use></svg></i></a></li>');
        } else {
          ele.append('<li class="prev"><a href="' + _xy_cms.otherPage.replace("{0}", page - 1) + '" class="prev"><span>上一页</span><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-arrow-left"></use></svg></i></a></li>');
        }
      }
      for (var i = 1; i <= pageCount; i++) {
        if (i == page) {
          ele.append('<li class="active"><a href="#">' + i + '</a></li>');
        } else {
          if (i == 1) {
            ele.append('<li><a href="' + _xy_cms.firstPage + '">' + i + '</a></li>');
          } else {
            ele.append('<li><a href="' + _xy_cms.otherPage.replace("{0}", i) + '">' + i + '</a></li>');
          }
        }
      }
      if (page < pageCount) {
        ele.append('<li class="next"><a href="' + _xy_cms.otherPage.replace("{0}", page + 1) + '" class="next"><span>下一页</span><i class="wpcom-icon wi"><svg aria-hidden="true"><use xlink:href="#wi-arrow-right"></use></svg></i></a></li>');
      }
    }
    document.addEventListener('DOMContentLoaded', function () {
      queryResult();
    });
  </script>
  <script>jQuery(function ($) { setup_share(1); });</script>

</body>

</html>